#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞ mcp-nest-boilerplate
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./create-from-template.sh <–Ω–æ–≤—ã–π-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π>

set -e  # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–Ω –∞—Ä–≥—É–º–µ–Ω—Ç —Å –∏–º–µ–Ω–µ–º –Ω–æ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
if [ $# -eq 0 ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: –ù–µ —É–∫–∞–∑–∞–Ω–æ –∏–º—è –Ω–æ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
    echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 <–Ω–æ–≤—ã–π-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π>"
    echo "–ü—Ä–∏–º–µ—Ä: $0 my-awesome-project"
    exit 1
fi

NEW_REPO_NAME=$1
TEMPLATE_REPO="git@github.com:isachivka/mcp-nest-boilerplate.git"
NEW_REPO_URL="git@github.com:isachivka/${NEW_REPO_NAME}.git"

echo "üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞..."
echo "üì¶ –®–∞–±–ª–æ–Ω: ${TEMPLATE_REPO}"
echo "üÜï –ù–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: ${NEW_REPO_URL}"
echo ""

# –ö–ª–æ–Ω–∏—Ä—É–µ–º —à–∞–±–ª–æ–Ω
echo "üì• –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞..."
git clone ${TEMPLATE_REPO} ${NEW_REPO_NAME}
cd ${NEW_REPO_NAME}

# –£–¥–∞–ª—è–µ–º —Å–≤—è–∑—å —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º
echo "üîó –ò–∑–º–µ–Ω–µ–Ω–∏–µ remote origin..."
git remote remove origin

# –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π remote
git remote add origin ${NEW_REPO_URL}

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ remote –∏–∑–º–µ–Ω–∏–ª—Å—è
echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ remote..."
git remote -v

# –ü—É—à–∏–º –≤ –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
echo "üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –≤ –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π..."
git push -u origin main

echo ""
echo "üéâ –ì–æ—Ç–æ–≤–æ! –ù–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω:"
echo "   üìÅ –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞: $(pwd)"
echo "   üåê GitHub: https://github.com/isachivka/${NEW_REPO_NAME}"
echo ""
echo "üí° –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "   1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ${NEW_REPO_NAME} —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ GitHub"
echo "   2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É: cd ${NEW_REPO_NAME}"
echo "   3. –ù–∞—á–Ω–∏—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É!"